var $event=$.event,resizeTimeout,Grid,$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(t,n){var s=this,o=arguments,e=function(){t.type="debouncedresize",$event.dispatch.apply(s,o)};resizeTimeout&&clearTimeout(resizeTimeout),n?e():resizeTimeout=setTimeout(e,$special.threshold)},threshold:250},BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(n){var s=this,e=typeof $.Deferred=="function"?$.Deferred():0,l=typeof e.notify=="function",t=s.find("img").add(s.filter("img")),a=[],r=[],o=[];$.isPlainObject(n)&&$.each(n,function(t,s){t==="callback"?n=s:e&&e[t](s)});function c(){var i=$(r),a=$(o);e&&(o.length?e.reject(t,i,a):e.resolve(t)),typeof n=="function"&&n.call(s,t,i,a)}function i(n,s){if(n.src===BLANK||$.inArray(n,a)!==-1)return;a.push(n),s?o.push(n):r.push(n),$.data(n,"imagesLoaded",{isBroken:s,src:n.src}),l&&e.notifyWith($(n),[s,t,$(r),$(o)]),t.length===a.length&&(setTimeout(c),t.off(".imagesLoaded"))}return t.length?t.on("load.imagesLoaded error.imagesLoaded",function(e){i(e.target,e.type==="error")}).each(function(s,e){var n=e.src,t=$.data(e,"imagesLoaded");if(t&&t.src===n){i(e,t.isBroken);return}if(e.complete&&e.naturalWidth!==void 0){i(e,e.naturalWidth===0||e.naturalHeight===0);return}(e.readyState||e.complete)&&(e.src=BLANK,e.src=n)}):c(),e?e.promise(s):s},Grid=function(){var n,f=$("*#og-grid"),t=f.children("li"),o=-1,r=-1,i=0,l=10,d=$(window),y=$("html, body"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},c=b[Modernizr.prefixed("transition")],s=Modernizr.csstransitions,e={minHeight:500,speed:350,easing:"ease"};function v(t){e=$.extend(!0,{},e,t),f.imagesLoaded(function(){u(!0),h(),g()})}function _(e){t=t.add(e),e.each(function(){var e=$(this);e.data({offsetTop:e.offset().top,height:e.height()})}),m(e)}function u(e){t.each(function(){var t=$(this);t.data("offsetTop",t.offset().top),e&&t.data("height",t.height())})}function g(){m(t),d.on("debouncedresize",function(){i=0,r=-1,u(),h();var e=$.data(this,"preview");typeof e!="undefined"&&a()})}function m(e){e.on("click","span.og-close",function(){return a(),!1}).children("a").on("click",function(){var t=$(this).parent();return o===Array.from(e).findIndex(e=>e==t[0])?a():j(t),!1})}function h(){n={width:d.width(),height:d.height()}}function j(t){var e=$.data(this,"preview"),n=t.data("offsetTop");if(i=0,typeof e!="undefined")if(r!==n)n>r&&(i=e.height),a();else return e.update(t),!1;r=n,e=$.data(this,"preview",new p(t)),e.open()}function a(){o=-1;var e=$.data(this,"preview");e.close(),$.removeData(this,"preview")}function p(e){this.$item=e,this.expandedIdx=Array.from(t).findIndex(e=>e==this.$item[0]),this.create(),this.update()}return p.prototype={create:function(){this.$title=$("<h3></h3>"),this.$description=$("<p></p>"),this.$href=$('<a href="#" class="button" target="_blank" rel="noreferrer">{{ .Site.Params.buttontext }}</a>'),this.$details=$('<div class="og-details"></div>').append(this.$title,this.$description,this.$href),this.$loading=$('<div class="og-loading"></div>'),this.$fullimage=$('<div class="og-fullimg"></div>').append(this.$loading),this.$closePreview=$('<span class="og-close"></span>'),this.$previewInner=$('<div class="og-expander-inner"></div>').append(this.$closePreview,this.$fullimage,this.$details),this.$previewEl=$('<div class="og-expander"></div>').append(this.$previewInner),this.$item.append(this.getEl()),s&&this.setTransition()},update:function(i){i&&(this.$item=i),o!==-1&&(a=t.eq(o),a.removeClass("og-expanded"),this.$item.addClass("og-expanded"),this.positionPreview()),o=this.$item.index();function r(e){return e.replace(/_/g,"-").replace(/ /g,"-").replace(/:/g,"-").replace(/\\/g,"-").replace(/\//g,"-").replace(/[^a-zA-Z0-9-]+/g,'').replace(/-{2,}/g,"-").toLowerCase()}var e,a,s=this.$item.children("a"),n={href:s.attr("href"),largesrc:s.data("largesrc"),title:s.data("title"),description:$(`#description-${r(s.data("title"))}`).html(),buttontext:s.data("buttontext")};this.$title.html(n.title),this.$description.html(n.description),n.buttontext?this.$href.text(n.buttontext):this.$href.text("{{ .Site.Params.buttontext }}"),n.href?(this.$href.attr("href",n.href),this.$href.show()):this.$href.hide(),e=this,typeof e.$largeImg!="undefined"&&e.$largeImg.remove(),e.$fullimage.is(":visible")&&(this.$loading.show(),$("<img/>").on("load",function(){var t=$(this);t.attr("src")===e.$item.children("a").data("largesrc")&&(e.$loading.hide(),e.$fullimage.find("img").remove(),e.$largeImg=t.fadeIn(350),e.$fullimage.append(e.$largeImg))}).attr("src",n.largesrc))},open:function(){setTimeout($.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var e=this,n=function(){s&&$(this).off(c),e.$item.removeClass("og-expanded"),e.$previewEl.remove()};return setTimeout($.proxy(function(){typeof this.$largeImg!="undefined"&&this.$largeImg.fadeOut("fast"),this.$previewEl.css("height",0);var e=t.eq(this.expandedIdx);e.css("height",e.data("height")).on(c,n),s||n.call()},this),25),!1},calcHeight:function(){var t=n.height-this.$item.data("height")-l,s=n.height;t<e.minHeight&&(t=e.minHeight,s=e.minHeight+this.$item.data("height")+l),this.height=t,this.itemHeight=s},setHeights:function(){var e=this,t=function(){s&&e.$item.off(c),e.$item.addClass("og-expanded")};this.calcHeight(),this.$previewEl.css("height",this.height),this.$item.css("height",this.itemHeight).on(c,t),s||t.call()},positionPreview:function(){var s=this.$item.data("offsetTop"),t=this.$previewEl.offset().top-i,o=this.height+this.$item.data("height")+l<=n.height?s:this.height<n.height?t-(n.height-this.height):t;y.animate({scrollTop:o},e.speed)},setTransition:function(){this.$previewEl.css("transition","height "+e.speed+"ms "+e.easing),this.$item.css("transition","height "+e.speed+"ms "+e.easing)},getEl:function(){return this.$previewEl}},{init:v,addItems:_}}(),$(function(){Grid.init()})